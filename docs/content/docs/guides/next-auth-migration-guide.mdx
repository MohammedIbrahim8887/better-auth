---
title: Migrating from NextAuth to BetterAuth
description: A step-by-step guide to getting started with BetterAuth.
---

In this guide, we'll explore how to seamlessly transition a project from Next Auth to Better Auth while ensuring no data or functionality is lost. 

## Before we get started

For this demonstration, we'll use Discord as our authentication provider. While this process should work with any other provider, we'll specifically focus on transitioning the Discord integration from NextAuth to BetterAuth.

**Ensure** you have your `Discord Client ID` and `Discord Client Secret` handy. You can retrieve these from the [Discord Developer Portal](https://discord.com/developers/applications). Once obtained, add them to your `.env` file if you haven't already:  

```env
DISCORD_CLIENT_ID=your-client-id  
DISCORD_CLIENT_SECRET=your-client-secret  
```  
<Steps>
    <Step>
        ### Setup Better auth

        Before we start the migration process, we need to setup BetterAuth in our project. You can use the [installation guide](/docs/guides/installation) to get started.
    </Step>
    <Step>
        ### Mapping Existing Columns
        
        Rather than replacing existing column names in your database, you can map them to Better Auth’s expected structure. This way, you can maintain your existing database schema. 


        #### User Schema

        Next Auth default uesr schema is the same as what is expected by Better Auth so there shouldn't be any problem there.

        #### Session Schema

        
        ```ts
        export const auth = betterAuth({
        // Other configs
            session: {
                fields: {
                    expiresAt: "expires" // Map expiresAt to expires
                }
            },
        });
        ```
        **NOTE:** If you are using Drizzle, you can map your schema directly in your `schema.ts` file to align with BetterAuth’s expected structure.
    </Step>

    <Step>
        ## Implement Route Listners

        Navigate to `src/app/api/auth` and rename the `[...nextauth]` file to `[...all]` in order to listen to all routes. Inside the route.ts, add the following code:

        ```typescript        
            import { toNextJsHandler } from "better-auth/next-js";
            import { auth } from "~/server/auth";

            export const { POST, GET } = toNextJsHandler(auth);
        ```
    </Step>

    <Step>
        ## Connecting all the dots

        Now, let’s bring everything together by ensuring your application logic properly integrates sessions and authentication clients.All we need to do is make our application logic use session and authClients.

        ### Add the proper session headers for TRPC
        To start, update the session handler in your `src/server/api/trpc.ts` file. Replace the existing session logic with the following:
        
        ```typescript
        export const createTRPCContext = async (opts: { headers: Headers }) => {
            // REPLACE THIS
            // const session = await auth();

            // WITH THIS
            const session = await auth.api.getSession({
               headers: opts.headers,
            });
            return {
                db,
                session,
                ...opts,
            };
        };
        ```

        ### Add Your Auth Client

        Next, create a file named `auth-client.ts` in either `src/libs/` or `src/utils/` (depending on your project’s structure) and paste the following code:

        ```typescript
        import { createAuthClient } from "better-auth/react";

        export const authClient = createAuthClient({
            baseURL: process.env.BASE_URL!
        })

        export const { signIn, signOut, useSession } = authClient;
        ```

        ### Add your social login functions

        To avoid hydration errors, create a dedicated `sign-in` button component. Use the following code for the SignInButton component:

        ```typescript
            import { authClient } from "./auth-client"

            export const signInDiscord = async () => {
                const data = await authClient.signIn.social({
                    provider: "discord"
                })
                return data
            }
        ```

        ### Create your Sign in Button

        To avoid hydration errors, create a dedicated `sign-in` button component. Use the following code for the SignInButton component:

        ```typescript
            "use client";

                import { signOut } from "~/libs/auth-client";
                import { signInDiscord } from "~/libs/social-login";

                export default function SignInButton({ session }: { session: any }) {
                    const handleAuth = () => {
                        session ? signOut() : signInDiscord();
                    };

                    return (
                        <button
                            onClick={handleAuth}
                            className="rounded-full bg-white/10 px-10 py-3 font-semibold no-underline transition hover:bg-white/20"
                        >
                            {session ? "Sign out" : "Sign in"}
                        </button>
                    );
                }

        ```

        ### Attach it to your frontend

        Add the newly created `SignInButton` to your application's home page or a relevant frontend component.

        ```typescript
            import Link from "next/link";
            import { LatestPost } from "~/app/_components/post";
            import { getSession } from "~/server/auth";
            import { api, HydrateClient } from "~/trpc/server";
            import SignInButton from "./_components/sign-in-button";

            export default async function Home() {
                const hello = await api.post.hello({ text: "from tRPC" });
                const session = await getSession();

                if (session?.user) {
                    void api.post.getLatest.prefetch();
                }

                return (
                    <HydrateClient>
                        <main className="flex min-h-screen flex-col items-center justify-center bg-gradient-to-b from-[#2e026d] to-[#15162c] text-white">
                            <div className="container flex flex-col items-center justify-center gap-12 px-4 py-16">
                                {/* Previous content */}
                                <div className="flex flex-col items-center gap-2">
                                    <p className="text-2xl text-white">
                                        {hello ? hello.greeting : "Loading tRPC query..."}
                                    </p>

                                    <div className="flex flex-col items-center justify-center gap-4">
                                        <p className="text-center text-2xl text-white">
                                            {session && <span>Logged in as {session.user?.name}</span>}
                                        </p>
                                        <SignInButton session={session} />
                                    </div>
                                </div>

                                {session?.user && <LatestPost />}
                            </div>
                        </main>
                    </HydrateClient>
                );
            }
        ```
    </Step>
</Steps>

## Wrapping up

Congratulations! You’ve successfully migrated from NextAuth to BetterAuth, ensuring your authentication logic is modernized and optimized.

**If** you'd like to see the complete code or a live demo, check out the full implementation with multiple auth added [here](https://github.com/Bekacru/t3-app-better-auth).